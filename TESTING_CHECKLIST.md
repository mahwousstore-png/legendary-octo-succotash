# قائمة اختبار نظام ربط المصروفات بالعهدة

## التحضير

### المتطلبات الأولية
- [ ] تطبيق migration على قاعدة البيانات
- [ ] وجود موظفين نشطين في النظام
- [ ] وجود فئات مصروفات

## اختبارات الموظف

### اختبار 1: إضافة مصروف مع رصيد عهدة كافٍ

**الخطوات:**
1. سجل دخول كموظف له رصيد عهدة (مثلاً 1000 ر.س)
2. اذهب إلى صفحة المصروفات
3. اضغط "إضافة مصروف"
4. املأ البيانات:
   - الوصف: "شراء أدوات مكتبية"
   - المبلغ: 150
   - الفئة: (اختر أي فئة)
   - التاريخ: (اختر تاريخ اليوم)
5. فعّل خيار "خصم من العهدة"

**النتائج المتوقعة:**
- [ ] يعرض النظام الرصيد الحالي: 1000 ر.س
- [ ] يعرض الرصيد بعد الخصم: 850 ر.س باللون الأخضر
- [ ] عند الضغط على "إضافة المصروف"، تظهر نافذة تأكيد
- [ ] عند التأكيد، تظهر رسالة نجاح مع الرصيد الجديد
- [ ] يتم إضافة المصروف إلى الجدول
- [ ] يتم تحديث رصيد العهدة إلى 850 ر.س

---

### اختبار 2: إضافة مصروف مع رصيد عهدة غير كافٍ

**الخطوات:**
1. سجل دخول كموظف له رصيد عهدة (مثلاً 100 ر.س)
2. اذهب إلى صفحة المصروفات
3. اضغط "إضافة مصروف"
4. املأ البيانات:
   - الوصف: "شراء معدات"
   - المبلغ: 500
   - الفئة: (اختر أي فئة)
   - التاريخ: (اختر تاريخ اليوم)
5. فعّل خيار "خصم من العهدة"

**النتائج المتوقعة:**
- [ ] يعرض النظام الرصيد الحالي: 100 ر.س
- [ ] يعرض الرصيد بعد الخصم: -400 ر.س باللون الأحمر
- [ ] يظهر تحذير: "تحذير: المبلغ المطلوب أكبر من رصيد العهدة المتاح"
- [ ] عند محاولة الحفظ، تظهر رسالة خطأ:
  "رصيد العهدة غير كافٍ. الرصيد المتاح: 100 ر.س والمطلوب: 500 ر.س"
- [ ] لا يتم حفظ المصروف
- [ ] يبقى الرصيد كما هو 100 ر.س

---

### اختبار 3: إضافة مصروف بدون خصم من العهدة

**الخطوات:**
1. سجل دخول كموظف
2. اذهب إلى صفحة المصروفات
3. اضغط "إضافة مصروف"
4. املأ البيانات
5. اترك خيار "خصم من العهدة" غير مفعل
6. احفظ المصروف

**النتائج المتوقعة:**
- [ ] يتم حفظ المصروف بنجاح
- [ ] رصيد العهدة لا يتغير
- [ ] لا تظهر رسالة تأكيد خصم

---

### اختبار 4: تأكيد استلام عهدة جديدة

**الخطوات:**
1. قم بإضافة عهدة للموظف من حساب المدير (انظر اختبار المدير 1)
2. سجل دخول كالموظف
3. اذهب إلى صفحة "عهد الموظفين"

**النتائج المتوقعة:**
- [ ] يظهر قسم "العهد في انتظار التأكيد" باللون الأزرق
- [ ] تظهر تفاصيل العهدة:
  - المبلغ
  - التاريخ
  - السبب
  - من قام بإضافتها
- [ ] زر "تأكيد الاستلام" باللون الأخضر
- [ ] زر "رفض" باللون الأحمر

4. اضغط "تأكيد الاستلام"

**النتائج المتوقعة:**
- [ ] تظهر رسالة نجاح مع الرصيد الجديد
- [ ] تختفي العهدة من قسم "المعلقة"
- [ ] تظهر في سجل العهد المؤكدة
- [ ] يتم تحديث الرصيد الحالي

---

### اختبار 5: رفض عهدة جديدة

**الخطوات:**
1. قم بإضافة عهدة للموظف من حساب المدير
2. سجل دخول كالموظف
3. اذهب إلى صفحة "عهد الموظفين"
4. في قسم العهد المعلقة، اضغط "رفض"
5. أكد الرفض في النافذة المنبثقة

**النتائج المتوقعة:**
- [ ] تظهر نافذة تأكيد الرفض
- [ ] عند التأكيد، تظهر رسالة "تم رفض العهدة"
- [ ] تختفي العهدة من قسم المعلقة
- [ ] لا يتم تحديث الرصيد
- [ ] لا تظهر في سجل العهد المؤكدة

---

## اختبارات المدير

### اختبار 6: إضافة عهدة للموظف

**الخطوات:**
1. سجل دخول كمدير
2. اذهب إلى صفحة "عهد الموظفين"
3. اختر موظف
4. اضغط "عملية جديدة"
5. املأ البيانات:
   - النوع: صرف عهده (إضافة للموظف)
   - المبلغ: 1000
   - التاريخ: (اختر تاريخ اليوم)
   - السبب: "عهدة شهر ديسمبر"
6. اضغط "تسجيل في العهده"

**النتائج المتوقعة:**
- [ ] تظهر رسالة: "تم إضافة العهدة بنجاح. في انتظار تأكيد الموظف"
- [ ] لا يتم تحديث رصيد الموظف فوراً
- [ ] تظهر العهدة في قسم "عهد معلقة" باللون الأصفر
- [ ] حالة العهدة: "في الانتظار"

---

### اختبار 7: عرض عهد معلقة للموظف (كمدير)

**الخطوات:**
1. سجل دخول كمدير
2. اذهب إلى صفحة موظف له عهد معلقة

**النتائج المتوقعة:**
- [ ] يظهر قسم "عهد معلقة" باللون الأصفر
- [ ] تظهر جميع العهد المعلقة لهذا الموظف
- [ ] تظهر حالة "في الانتظار" لكل عهدة

---

### اختبار 8: إضافة مصروف للموظف بدون خصم من العهدة

**الخطوات:**
1. سجل دخول كمدير
2. اذهب إلى صفحة المصروفات
3. اضغط "إضافة مصروف"
4. املأ البيانات
5. لاحظ وجود خيار "خصم من العهدة (اختياري)"
6. اترك الخيار غير مفعل
7. احفظ المصروف

**النتائج المتوقعة:**
- [ ] يظهر نص توضيحي: "يمكن للمدير إضافة مصروف بدون خصم من العهدة"
- [ ] يتم حفظ المصروف بنجاح
- [ ] لا يتم خصم من عهدة أي موظف

---

## اختبارات التكامل

### اختبار 9: سيناريو كامل - من إضافة عهدة إلى خصم مصروف

**الخطوات:**
1. (مدير) أضف عهدة 1000 ر.س لموظف
2. (موظف) أكد استلام العهدة
3. (موظف) أضف مصروف 300 ر.س مع خصم من العهدة
4. (موظف) أضف مصروف 200 ر.س مع خصم من العهدة
5. (مدير) راجع رصيد الموظف

**النتائج المتوقعة:**
- [ ] الرصيد النهائي: 500 ر.س (1000 - 300 - 200)
- [ ] جميع المعاملات مسجلة بشكل صحيح
- [ ] تواريخ التأكيد محفوظة

---

### اختبار 10: اختبار الصلاحيات

**الخطوات:**
1. حاول الوصول إلى عهد موظف آخر كموظف
2. حاول تأكيد عهدة موظف آخر

**النتائج المتوقعة:**
- [ ] لا يمكن للموظف رؤية أو تأكيد عهد موظفين آخرين
- [ ] المدير فقط يمكنه رؤية جميع العهد

---

## اختبارات الأداء

### اختبار 11: تحميل البيانات

**الخطوات:**
1. أضف 50+ معاملة عهدة لموظف واحد
2. افتح صفحة تفاصيل الموظف

**النتائج المتوقعة:**
- [ ] تحميل الصفحة بسرعة معقولة (< 3 ثوان)
- [ ] عرض جميع المعاملات بشكل صحيح
- [ ] عمل التمرير (scroll) بسلاسة

---

## اختبارات الأخطاء

### اختبار 12: التعامل مع أخطاء الشبكة

**الخطوات:**
1. افصل الاتصال بالإنترنت
2. حاول إضافة مصروف أو تأكيد عهدة

**النتائج المتوقعة:**
- [ ] تظهر رسالة خطأ واضحة بالعربية
- [ ] لا تتغير البيانات في الواجهة
- [ ] يمكن المحاولة مرة أخرى عند عودة الاتصال

---

## الخلاصة

- [ ] جميع الاختبارات نجحت
- [ ] الرسائل واضحة ومفهومة بالعربية
- [ ] الواجهة سهلة الاستخدام
- [ ] البيانات متزامنة بشكل صحيح
- [ ] الصلاحيات محددة بشكل صحيح
- [ ] لا توجد أخطاء في console

---

## ملاحظات إضافية

استخدم هذا القسم لتسجيل أي ملاحظات أو مشاكل واجهتها أثناء الاختبار:

```
[أضف ملاحظاتك هنا]
```
